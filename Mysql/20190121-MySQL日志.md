___
- FileName: 20190121-MySQL日志.md
- Author: ihuangch -huangch96@qq.com
- Description: ---
- Create:2019-01-21 11:27:31
___

### MySQL日志
日志是MySQL数据库的重要组成部分。日志文件中记录着MySQL数据库运行期间发生的变化，也就是说用来
记录着MySQL数据库客户端连接状况、SQL语句的执行情况和错误信息等。当数据库遭到意外的损坏时，
可以通过日志文件查看出错的原因，并且可以通过日志文件进行数据恢复。

### MySQL日志分类
- 查询日志: query log(一般不开启)
- 慢查询日志: slow query log（查询未必真的很慢）
- 错误日志: error log (服务启动和关闭的正常日志也在这里面)
- 二进制日志: binary log（备份恢复复制都是依靠这个日志）
- 中继日志: relay log（MySQL复制架构种需要的日志文件）
- 事务日志: transaction log（支持事务存储引擎）
**查看日志相关的变量**:
```mysql
MariaDB [(none)]> show global variables like "%log%"\G
```

##### 1. 查询日志
查询日志，一般不开启，因为一个非常繁忙的数据库服务器，其查询会有很多，每一次都记录会导致系统
性能下降，而且会有额外的空间开销。MySQL默认没有开启这个日志。  
如果开启查询日志，包括show、set操作也会被记录，不仅仅是select语句。  
查询日志的相关变量:  
- general_log=ON|OFF				# 是否启用查询日志
- general_log_file=HOSTNAME.log  	# 日志文件名称(默认为主机名.log)
- log_output=FILE|TABLE|NONE 	   	# 日志输出格式
	- FILE: 记录于general_log_file种
	- TABLE: 记录于表种。MySQL库中会自动生成一个表记录
	- NONE: 不记录
	- TABLE和FILE可以同时出现，使用逗号分开

```mysql
MariaDB [(none)]> show global variables like "general_log";
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| general_log   | OFF   |
+---------------+-------+
1 row in set (0.01 sec)

MariaDB [(none)]> show global variables like "general_log_file";
+------------------+----------------+
| Variable_name    | Value          |
+------------------+----------------+
| general_log_file | centos-112.log |
+------------------+----------------+
1 row in set (0.00 sec)

MariaDB [(none)]> show global variables like "log_output";
+---------------+-------+
| Variable_name | Value |
+---------------+-------+
| log_output    | FILE  |
+---------------+-------+
1 row in set (0.01 sec)
```

##### 2. 慢查询日志
查询执行时长超过指定时长的查询，即为慢查询。这里的慢
